<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <meta th:if="${_csrf != null}" name="_csrf" th:content="${_csrf.token}" />
    <meta th:if="${_csrf != null}" name="_csrf_header" th:content="${_csrf.headerName}" />
    <title>вѓ┤Ж░ђ ВЊ┤ вдгви░ - PetTrip</title>
    <link rel="stylesheet" th:href="@{/css/common/common.css}" />
    <link rel="stylesheet" th:href="@{/css/mypage.css}" />
    <link rel="stylesheet" th:href="@{/css/common/imageModal.css}" />
  </head>
  <body>
    <!-- ьЌцвЇћ ьЈгьЋе -->
    <div th:replace="~{common/header :: siteHeader}"></div>

    <!-- вДѕВЮ┤ьјўВЮ┤ВДђ вЕћВЮИ В╗еьЁїВЮ┤вёѕ -->
    <div class="mypage-container">
      <!-- ВЎ╝Вфй ВѓгВЮ┤вЊюв░ћ -->
      <aside class="sidebar">
        <nav class="sidebar-nav">
          <ul>
            <li>
              <a href="/mypage">вѓ┤ ВаЋв│┤</a>
            </li>
            <li>
              <a href="/mypage/likes">В░юьЋю ВъЦВєї</a>
            </li>
            <li>
              <a href="/mypage/reviews" class="active">вѓ┤Ж░ђ ВЊ┤ вдгви░</a>
            </li>
          </ul>
        </nav>
      </aside>

      <!-- вЕћВЮИ ВйўьЁљВИа ВўЂВЌГ -->
      <main class="main-content">
        <h1 class="content-title">вѓ┤Ж░ђ ВЊ┤ вдгви░</h1>

        <!-- вдгви░Ж░ђ ВЌєВЮё вЋї -->
        <div th:if="${userReviews == null or userReviews.isEmpty()}" class="empty-state">
          <div class="empty-icon">­ЪЊЮ</div>
          <h2>ВъЉВё▒ьЋю вдгви░Ж░ђ ВЌєВіхвІѕвІц</h2>
          <p>в░ўвацвЈЎвг╝Ж│╝ ьЋеЖ╗ў вІцвЁђВўе ВъЦВєїВЌљ вдгви░вЦ╝ вѓеЖ▓ев│┤ВёИВџћ!</p>
          <a href="/" class="cta-button">ВъЦВєї В░ЙВЋёв│┤ЖИ░</a>
        </div>

        <!-- вдгви░ вфЕвАЮ -->
        <div th:if="${userReviews != null and !userReviews.isEmpty()}" class="reviews-section">
          <div class="reviews-stats">
            <p class="review-count">В┤Ю <span th:text="${#lists.size(userReviews)}">0</span>Ж░юВЮў вдгви░</p>
          </div>

          <div class="reviews-list">
            <div th:each="review : ${userReviews}" class="review-card">
              <!-- вдгви░ ьЌцвЇћ -->
              <div class="review-header">
                <div class="review-place-info">
                  <a th:href="|/place/${review.placeId}|" class="place-name-link" th:text="${review.placeName}">ВъЦВєївфЁ</a>
                  <div class="review-meta">
                    <div class="review-rating">
                      <div class="stars" th:style="|--percent: ${(review.rating != null ? review.rating : 0) * 20}%|"></div>
                      <span class="rating-text" th:text="${review.rating != null ? #numbers.formatDecimal(review.rating, 1, 1) : '0.0'}">0.0</span>
                    </div>
                    <span class="review-date" th:text="${#temporals.format(review.createdAt, 'yyyy.MM.dd')}">2024.01.01</span>
                  </div>
                </div>

                <!-- вдгви░ ВЋАВЁў в▓ёьі╝вЊц -->
                <div class="review-actions">
                  <button type="button" class="btn-delete-review delete-review-btn" th:data-review-id="${review.id}">ВѓГВаю</button>
                </div>
              </div>

              <!-- вдгви░ вѓ┤ВџЕ -->
              <div class="review-content">
                <p class="review-text" th:text="${review.content}">вдгви░ вѓ┤ВџЕ</p>
              </div>

              <!-- вдгви░ ВЮ┤в»ИВДђвЊц -->
              <div th:if="${review.images != null and !review.images.isEmpty()}" class="review-images">
                <div class="images-grid">
                  <div th:each="image, iterStat : ${review.images}" class="image-item">
                    <img th:src="${image}" th:alt="'вдгви░ ВЮ┤в»ИВДђ ' + ${iterStat.index + 1}" alt="вдгви░ ВЮ┤в»ИВДђ" onerror="this.style.display='none';" />
                  </div>
                </div>
              </div>

              <!-- в░ўвацвЈЎвг╝ ВаЋв│┤ -->
              <div th:if="${review.petInfos != null and !review.petInfos.isEmpty()}" class="pet-info-section">
                <h4 class="pet-info-title">ьЋеЖ╗ўьЋю в░ўвацвЈЎвг╝</h4>
                <div class="pet-tags">
                  <span th:each="pet : ${review.petInfos}" class="pet-tag" th:text="${pet.type} + ' ┬и ' + ${pet.breed} + ' ┬и ' + ${pet.weightKg} + 'kg'">
                    Ж░ЋВЋёВДђ ┬и Ж│евЊавдгьіИвдгв▓ё ┬и 25kg
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </main>
    </div>

    <!-- JavaScript ьїїВЮ╝ ьЈгьЋе -->
    <script th:src="@{/scripts/mypage.js}"></script>
    <script th:src="@{/scripts/mypageReviews.js}"></script>
    <script th:src="@{/scripts/imageModal.js}"></script>
  </body>
</html>
