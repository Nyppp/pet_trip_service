<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="UTF-8" />
    <title>떠나개 - 반려동물 동반 여행 플랫폼</title>
    <link rel="stylesheet" th:href="@{/css/main.css}" />


    <style>

    </style>
  </head>
  <body>
    <!-- 공통 헤더 포함 -->
    <div th:replace="~{common/header :: siteHeader}"></div>

    <!-- 검색 -->
    <section class="search-bar">
      <div class="container">
        <select>
          <option value="all">전체</option>
          <option th:each="cat : ${category.entrySet()}"
                  th:value="${cat.key}"
                  th:text="${cat.value}">

          </option>
        </select>
        <input type="text" placeholder="검색어를 입력하세요" />
        <button>검색</button>
        <a th:href="@{/location/permission}">지도로 검색</a>
      </div>
    </section>

    <!-- 본문: 인기 장소 등 -->
    <div class="main-content">
      <div class="container">
        <h2 class="section-title">지금 인기있는 장소</h2>
        <div th:if="${places != null and !places.isEmpty()}" class="likes-section">
          <div class="places-carousel">
            <button class="carousel-btn prev" type="button" aria-label="이전">‹</button>

            <div class="carousel-track" id="placesTrack">
              <div th:each="place : ${places}" class="place-card">
                <div class="place-image">
                  <img th:if="${place.imageUrls != null and !place.imageUrls.isEmpty()}"
                       th:src="${place.imageUrls[0]}"
                       th:alt="${place.name} + ' 이미지'"
                       onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';" />
                  <div th:if="${place.imageUrls == null or place.imageUrls.isEmpty()}" class="no-image-placeholder">
                    <span>준비된 이미지가 없습니다</span>
                  </div>
                  <div class="no-image-placeholder" style="display:none">
                    <span>이미지를 불러올 수 없습니다</span>
                  </div>
                </div>

                <div class="place-info">
                  <h3 class="place-name" th:text="${place.name}">장소 이름</h3>
                  <p class="place-category" th:text="${place.categoryName}">카테고리</p>
                  <p class="place-address" th:text="${place.address}">주소</p>
                  <div class="place-meta">
                    <div class="rating">
                      <div class="stars" th:style="|--percent: ${(place.rating != null ? place.rating : 0) * 20}%|"></div>
                      <span class="rating-text" th:text="${place.rating != null ? #numbers.formatDecimal(place.rating, 1, 1) : '0.0'}">0.0</span>
                    </div>
                    <div class="like-count">
                      <img src="/images/heart_filled.svg" alt="찜" width="16" height="16" />
                      <span th:text="${place.liked}">0</span>
                    </div>
                  </div>
                </div>

                <div class="place-actions">
                  <a th:href="|/place/${place.id}|" class="view-detail-btn">상세보기</a>
                </div>
              </div>
            </div>

            <button class="carousel-btn next" type="button" aria-label="다음">›</button>
          </div>
        </div>
      </div>
    </div>

    <!-- 채팅 버튼 -->
    <div id="chat-toggle-btn">
      <button>
        <img class="chat-btn-logo" src="/images/chatbot_logo.png" alt="채팅하기" />
      </button>
    </div>

    <!-- 채팅 모달 -->
    <div id="chat-modal" class="sr-only">
      <div id="chat-modal-header">
        <img class="chat-btn-logo" src="/images/chatbot_logo.png" alt="채팅하기" />
        <div>
          <div class="chat-modal-header-title">떠나개</div>
          <button>운영시간 09:00 ~ 18:00</button>
        </div>
      </div>
      <div id="chat-modal-body">
        <div class="chat-message bot-message">무엇을 도와드릴까요?</div>
      </div>
      <div id="chat-modal-input">
        <input id="chat-input" type="text" placeholder="메세지를 입력하세요." />
        <button>보내기</button>
      </div>
    </div>

    <!-- 푸터 -->
    <footer>
      <div class="container">&copy; 2025 떠나개. 반려동물과 함께하는 행복한 여행을 응원합니다.</div>
    </footer>

    <script src="/scripts/main.js"></script>
    <script src="/scripts/mainFront.js"></script>
    <script>

    </script>
  </body>
</html>
